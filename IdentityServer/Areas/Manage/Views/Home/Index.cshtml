@(Layout = null)
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"]</title>

    <partial name="_ElementUiStylesPartial" />
    <partial name="_AvueStylesPartial" />
    <partial name="_AnimateCssStylesPartial" />
    <partial name="_SiteStylesPartial" />
    
    <style>
        .el-scrollbar .el-scrollbar__wrap {
            overflow-x: hidden;
        }
    </style>
</head>
<body style="margin: 0">
    <div id="vue-app">
        <el-container v-bind:style="{height: styleCtrlObject.windowHeight + 'px'}">
            <el-header style="border-bottom: 1px solid #778899">
                <el-row>
                    <el-col>
                        Header
                    </el-col>
                </el-row>
            </el-header>
            <el-container>
                <el-aside style="border-right: 1px solid #778899" width="200px">
                    <el-scrollbar :native="false"
                                  :noresize="false"
                                  style="height: 100%">
                        <el-row>
                            <el-col>
                                <el-menu ref="menu"
                                         @@open="handleOpen"
                                         style="border: none; width: max-content; min-width: 100%">
                                    <el-submenu index="sys">
                                        <template slot="title">
                                            <i class="el-icon-location"></i>
                                            <span>系统</span>
                                        </template>
                                        <el-menu-item-group>
                                            <template slot="title">管理</template>
                                            <el-menu-item index="sys-trans">本地化翻译管理</el-menu-item>
                                            <el-menu-item index="sys-user">用户管理</el-menu-item>
                                            <el-menu-item index="sys-org">组织管理</el-menu-item>
                                            <el-menu-item index="sys-permDef">权限定义</el-menu-item>
                                            <el-menu-item index="sys-authRule">授权规则定义</el-menu-item>
                                            <el-menu-item index="sys-permDecOrg">组织权限分配</el-menu-item>
                                            <el-menu-item index="sys-permDecRole">角色权限分配</el-menu-item>
                                            <el-menu-item index="sys-permDecUser">用户权限分配</el-menu-item>
                                        </el-menu-item-group>
                                        <el-menu-item-group title="分组2">
                                            <el-menu-item index="1-3">选项3</el-menu-item>
                                        </el-menu-item-group>
                                        <el-submenu index="1-4">
                                            <template slot="title">选项4</template>
                                            <el-menu-item index="1-4-1">选项1</el-menu-item>
                                        </el-submenu>
                                    </el-submenu>
                                    <el-menu-item index="2">
                                        <i class="el-icon-menu"></i>
                                        <span slot="title">导航二</span>
                                    </el-menu-item>
                                    <el-menu-item index="3" disabled>
                                        <i class="el-icon-document"></i>
                                        <span slot="title">导航三</span>
                                    </el-menu-item>
                                    <el-menu-item index="4">
                                        <i class="el-icon-setting"></i>
                                        <span slot="title">导航四</span>
                                    </el-menu-item>
                                </el-menu>
                            </el-col>
                        </el-row>
                    </el-scrollbar>
                </el-aside>
                <el-container>
                    <el-main>
                        <el-row>
                            <el-col>
                                Main
                            </el-col>
                        </el-row>
                        <el-row>
                            <el-col>
                                <el-tabs type="border-card"
                                         closable
                                         @@tab-remove="removeTab"
                                         v-model="activeTab">

                                    <el-tab-pane :lazy="true"
                                                 :key="item.name"
                                                 v-for="(item, index) in editableTabs"
                                                 :label="item.title"
                                                 :name="item.name"
                                                 style="height: 100%">
                                        {{item.content}}
                                        <iframe style="width: 100%; height: 100%" src="https://localhost:5001/"></iframe>
                                    </el-tab-pane>
                                </el-tabs>
                            </el-col>
                        </el-row>
                    </el-main>
                    <el-footer style="border-top: 1px solid #778899">
                        <el-row>
                            <el-col>
                                Footer
                            </el-col>
                        </el-row>
                    </el-footer>
                </el-container>
            </el-container>
        </el-container>
    </div>

    <partial name="_JQueryScriptsPartial" />
    <partial name="_VueScriptsPartial" />
    <partial name="_ElementUiScriptsPartial" />
    <partial name="_AvueScriptsPartial" />
    <partial name="_SiteScriptsPartial" />

    <script>
        //挂载JQuery到Vue原型链
        Vue.prototype.$ = $;

        var vueApp = new Vue({
            el: '#vue-app',
            data: function () {
                return {
                    styleCtrlObject: {
                        windowHeight: window.innerHeight
                    },
                    activeTab:"bbb",
                    editableTabs: [
                        { name: 'aaa', title: 'aaa', content: 'aaa' },
                        { name: 'bbb', title: 'bbb', content: 'bbb' },
                        { name: 'ccc', title: 'ccc', content: 'ccc' },
                    ]
                };
            },
            mounted: function () {
                console.log(this.$refs.menu);
                var _this = this;

                this.$(window).on('resize',
                    function () {
                        _this.styleCtrlObject.windowHeight = window.innerHeight;
                    });
            },
            methods: {
                handleOpen(key, keyPath) {
                    //this.$message('打开菜单。key:' + key + '；keyPath:' + keyPath);
                },
                removeTab(targetName) {
                    var _this = this;

                    this.editableTabs.forEach((tab, index) => {
                        if (tab.name === targetName) {
                            var nextTab = _this.editableTabs[index + 1] || _this.editableTabs[index - 1];
                            if (nextTab) {
                                _this.activeTab = nextTab.name;
                            }
                        }
                    });
                    this.editableTabs = this.editableTabs.filter(tab => tab.name !== targetName);
                }
            }
        });
    </script>
</body>
</html>
